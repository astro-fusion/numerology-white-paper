# ü™ê Vedic Numerology-Astrology API Deployment Guide

This guide explains how to deploy the REST API for real-time numerology and astrology calculations.

## üöÄ Deployment Options

### 1. **FastAPI on Render** (Recommended - Free Tier Available)

**Pros:** Free tier, easy deployment, automatic HTTPS
**Cons:** Cold starts, monthly usage limits

#### Steps:

1. **Create Render Account**
   - Go to [render.com](https://render.com)
   - Sign up with GitHub

2. **Deploy from GitHub**
   - Click "New +" ‚Üí "Web Service"
   - Connect your `astro-fusion/numerology-white-paper` repository
   - Configure build settings:
     ```bash
     Build Command: pip install -r requirements-api.txt
     Start Command: uvicorn api:app --host 0.0.0.0 --port $PORT
     ```

3. **Environment Setup**
   - Add environment variable: `PYTHON_VERSION=3.11.0`
   - Service will be available at: `https://your-app-name.onrender.com`

4. **API Endpoints**
   ```
   GET  https://your-app-name.onrender.com/docs          # Interactive API docs
   GET  https://your-app-name.onrender.com/api/v1/health # Health check
   POST https://your-app-name.onrender.com/api/v1/analysis # Calculate
   ```

### 2. **FastAPI on Railway** (Alternative Free Option)

**Pros:** Fast deployments, good performance
**Cons:** Limited free hours per month

#### Steps:

1. **Railway Account**: [railway.app](https://railway.app)

2. **Deploy**:
   ```bash
   railway login
   railway init
   railway up
   ```

3. **API URL**: Automatically generated by Railway

### 3. **GitHub Actions Webhook API** (Completely Free)

**Pros:** No hosting costs, runs on GitHub infrastructure
**Cons:** Async processing, rate limits

#### How it Works:

1. **Trigger Calculation** via repository dispatch:
   ```bash
   curl -X POST \
     -H "Authorization: token YOUR_GITHUB_TOKEN" \
     -H "Accept: application/vnd.github.v3+json" \
     https://api.github.com/repos/astro-fusion/numerology-white-paper/dispatches \
     -d '{
       "event_type": "calculate-numerology",
       "client_payload": {
         "birth_date": "1984-08-27",
         "birth_time": "10:30",
         "latitude": 28.6139,
         "longitude": 77.1025
       }
     }'
   ```

   ‚ö†Ô∏è **Security Warning**: Always use fine-grained personal access tokens with the minimum required scopes. For repository dispatches, use tokens with only the `repo` scope. Avoid using classic personal access tokens with broad permissions like `repo`, `public_repo`, or `admin:repo_hook` unless absolutely necessary. This API is intended for backend-to-backend integration, not direct browser usage. Never expose tokens in client-side code or public repositories.

2. **Monitor Results**: Check GitHub Actions runs for results

3. **Get Results**: Download artifacts from completed runs

### 4. **Streamlit Cloud** (Already Deployed)

Your Streamlit app is already available at:
`https://share.streamlit.io/astro-fusion/numerology-app/main/app.py`

## üîß API Usage Examples

### JavaScript Client

```html
<script src="api-client.js"></script>
<script>
const vedicAPI = new VedicNumerologyAPI();

// Calculate numerology
const result = await vedicAPI.completeAnalysis({
    birth_date: "1984-08-27",
    birth_time: "10:30",
    latitude: 28.6139,
    longitude: 77.1025
});

console.log("Mulanka:", result.numerology.mulanka);
console.log("Bhagyanka:", result.numerology.bhagyanka);
</script>
```

### Python Client

```python
import requests

# FastAPI endpoint
response = requests.post("https://your-api-url.onrender.com/api/v1/analysis", json={
    "birth_date": "1984-08-27",
    "birth_time": "10:30",
    "latitude": 28.6139,
    "longitude": 77.1025
})

result = response.json()
print("Results:", result)
```

### cURL Examples

```bash
# Health check
curl https://your-api-url.onrender.com/api/v1/health

# Complete analysis
curl -X POST "https://your-api-url.onrender.com/api/v1/analysis" \
  -H "Content-Type: application/json" \
  -d '{
    "birth_date": "1984-08-27",
    "birth_time": "10:30",
    "latitude": 28.6139,
    "longitude": 77.1025
  }'
```

## üìä API Endpoints

### Core Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/` | API information |
| `GET` | `/docs` | Interactive API documentation |
| `GET` | `/api/v1/health` | Health check |
| `POST` | `/api/v1/numerology` | Calculate numerology only |
| `POST` | `/api/v1/astrology` | Calculate astrology only |
| `POST` | `/api/v1/analysis` | Complete analysis |
| `GET` | `/api/v1/planets` | Planet information |
| `GET` | `/api/v1/examples` | Usage examples |

### Request/Response Format

**Request:**
```json
{
  "birth_date": "1984-08-27",
  "birth_time": "10:30",
  "latitude": 28.6139,
  "longitude": 77.1025,
  "timezone": "Asia/Kolkata",
  "ayanamsa_system": "lahiri"
}
```

**Response:**
```json
{
  "numerology": {
    "mulanka": {"number": 9, "planet": "Mars"},
    "bhagyanka": {"number": 3, "planet": "Jupiter"}
  },
  "support_analysis": {
    "mulanka": {"support_level": "Excellent Support", "score": 85.0},
    "bhagyanka": {"support_level": "Good Support", "score": 78.0},
    "overall": {"harmony_level": "Excellent Harmony"}
  },
  "timestamp": "2025-01-14T10:30:00"
}
```

## üîí Security & Rate Limiting

### Authentication
- **GitHub Actions**: Uses repository tokens
- **Deployed APIs**: Public endpoints (consider API keys for production)

### Rate Limits
- **GitHub Actions**: 1000 requests per hour per repository
- **Render**: Varies by plan (free tier has limits)
- **Railway**: Based on plan usage

## üß™ Testing the API

### Local Testing

```bash
# Start local API server
uvicorn api:app --reload

# Test endpoints
curl http://localhost:8000/api/v1/health
```

### Online Testing

```bash
# Test deployed API
curl https://your-api-url.onrender.com/api/v1/health

# Test with sample data
curl -X POST "https://your-api-url.onrender.com/api/v1/analysis" \
  -H "Content-Type: application/json" \
  -d '{"birth_date": "1984-08-27", "latitude": 28.6139, "longitude": 77.1025}'
```

## üöÄ Production Deployment Checklist

- [ ] Choose hosting platform (Render/Railway)
- [ ] Set up CI/CD for automatic deployments
- [ ] Configure monitoring and logging
- [ ] Set up error handling and retries
- [ ] Add API documentation
- [ ] Configure CORS for web applications
- [ ] Set up rate limiting if needed
- [ ] Add input validation and sanitization

## üí° Integration Ideas

### Web Applications
- Embed calculators in websites
- Create mobile apps with API backend
- Build educational platforms

### Research Tools
- Batch processing for studies
- Statistical analysis integrations
- Academic paper generation

### Developer Tools
- SDKs for different languages
- Command-line interfaces
- Integration with existing astrology software

## üìû Support

- **Issues**: [GitHub Issues](https://github.com/astro-fusion/numerology-white-paper/issues)
- **API Docs**: Available at `/docs` endpoint on deployed API
- **Examples**: Check `/api/v1/examples` endpoint

---

**Ready to deploy?** Choose your hosting platform and get your API running in minutes! üöÄ